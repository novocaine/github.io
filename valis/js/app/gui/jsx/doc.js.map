{"version":3,"sources":["../../../../../../www/js/app/gui/jsx/doc.js"],"names":[],"mappings":"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","file":"doc.js","sourcesContent":["define(['react',\n        'react-dom',\n        'jquery-ui',\n        'jquery',\n        'app/gui/jsx/patch',\n        'app/vobject_factory',\n        'lodash',\n        'filesaver'],\n(React, ReactDOM, jqueryui, $, patchComponent, vobjectFactory, _, filesaver) => {\n  /**\n   * The top-level 'document' component.\n   */\n  const Doc = React.createClass({\n    propTypes: {\n      patchModel: React.PropTypes.object.isRequired\n    },\n\n    render() {\n      return (\n        <div className=\"doc\">\n          <div className=\"toolbar\">\n            <Palette vobjectClasses={\n              this.props.patchModel.vobjectFactory.constructor.vobjectClasses\n            } />\n            <ToJSON doc={this} />\n            <EnableAudio doc={this} />\n          </div>\n          <patchComponent.PatchComponent ref=\"rootPatch\" doc={this}\n            patchModel={this.props.patchModel}\n          />\n        </div>\n      );\n    }\n  });\n\n  /**\n   * The tool palette, containing vobjects to drag into the patch.\n   */\n  const Palette = React.createClass({\n    propTypes: {\n      vobjectClasses: React.PropTypes.object.isRequired\n    },\n\n    render() {\n      return (<ul className=\"palette\"> {\n        _.map(this.props.vobjectClasses, (vclass, cname) => {\n          return (\n              <li className=\"palette-item\" key={cname} data-classname={cname}>\n                {cname}\n              </li>\n            );\n        })\n      } </ul>);\n    },\n\n    componentDidMount() {\n      // XXX: I think .draggable will break when we update Palette\n      // (but we don't yet)\n      $(ReactDOM.findDOMNode(this)).find('li').each((i, li) => {\n        $(li).draggable({\n          opacity: 0.7,\n          helper: 'clone',\n          revert: 'invalid'\n        });\n      });\n    }\n  });\n\n  const ToJSON = React.createClass({\n    propTypes: {\n      doc: React.PropTypes.object.isRequired\n    },\n\n    render() {\n      return (\n        <button className=\"to-json\" onClick={this.onClick}>{\n          this.props.doc.props.patchModel.audioEnabled() ?\n            'toJSON' : 'Enable Audio'\n        }\n        </button>);\n    },\n\n    onClick() {\n      const json = JSON.stringify(this.props.doc.props.patchModel.toJSON());\n      const blob = new Blob([json], { type: 'application/json;charset=utf-8' });\n      filesaver(blob, 'valis.json');\n    }\n  });\n\n  const EnableAudio = React.createClass({\n    propTypes: {\n      doc: React.PropTypes.object.isRequired\n    },\n\n    render() {\n      return (\n        <button className=\"enable-audio\" onClick={this.onClick}>{\n          this.props.doc.props.patchModel.audioEnabled() ?\n            'Disable Audio' : 'Enable Audio'\n        }\n        </button>);\n    },\n\n    onClick() {\n      this.props.doc.props.patchModel.enableAudio(\n        !this.props.doc.props.patchModel.audioEnabled());\n      this.setState({});\n    }\n  });\n\n  const render = (model) => {\n    $('#splash-loading').hide();\n    ReactDOM.render(<Doc patchModel={model} />,\n      document.getElementById('doc'));\n  };\n\n  return {\n    Doc,\n    render\n  };\n});\n"]}