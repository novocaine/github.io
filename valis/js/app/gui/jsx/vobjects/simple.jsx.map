{"version":3,"sources":["../../../../../../../www/js/app/gui/jsx/vobjects/simple.jsx"],"names":[],"mappings":"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","file":"simple.jsx","sourcesContent":["define(['lib/react', 'app/gui/jsx/util', 'jquery', 'lib/lodash'],\n(React, util, $, _) => {\n  /**\n   * Implementation of a default vobject with no fancy custom gui\n   */\n  const SimpleVObjectComponent = React.createClass({\n    propTypes: {\n      patchModel: React.PropTypes.object.isRequired,\n      patchComponent: React.PropTypes.object.isRequired,\n      vobject: React.PropTypes.object.isRequired\n    },\n\n    componentDidMount: () => {\n      this.makeDraggable();\n    },\n\n    onOutputMouseDown: (e) => {\n      const patchElem = $(this.getDOMNode()).parents('.patch');\n      if (!patchElem.length) {\n        throw new Error(\"couldn't find parent patch\");\n      }\n\n      this.props.patchComponent.startDrawingDedge(this,\n        parseInt($(e.currentTarget).attr('data-output-index'), 10),\n        e.clientX,\n        e.clientY);\n\n      e.stopPropagation();\n    },\n\n    makeDraggable: () => {\n      $(this.getDOMNode()).draggable({\n        drag: _.bind((event, ui) => {\n          // move the patch\n          this.props.patchModel.setVobjectPosition(this.props.vobject.id,\n            ui.position.left,\n            ui.position.top);\n\n          // tell the parent patch to redraw it\n          this.props.patchComponent.updateVobject(this);\n        }, this),\n        stop: _.bind((event, ui) => {\n          this.props.patchModel.setVobjectPosition(this.props.vobject.id,\n              ui.position.left,\n              ui.position.top);\n        }, this),\n      }).addClass('draggable');\n    },\n\n    render: () => {\n      const pos = this.props.patchModel.getVobjectPosition(this.props.vobject.id);\n      const style = {\n        position: 'absolute',\n        top: pos.y,\n        left: pos.x\n      };\n\n      return (\n        <div className=\"vobject-simple\" data-vobject-id={this.props.vobject.id}\n          style={style}\n        >\n          <div className=\"inputs\">\n            {\n              _.range(this.props.vobject.numInputs()).map((i) =>\n                <span className=\"input\" data-input-index={i}></span>\n              )\n            }\n          </div>\n          <div className=\"title\">{this.props.vobject.constructor.vobjectClass}</div>\n          <div className=\"outputs\">\n            {\n              _.range(this.props.vobject.numOutputs()).map((i) =>\n                (<span className=\"output\" data-output-index={i}\n                  onMouseDown={this.onOutputMouseDown}\n                />)\n              , this)\n            }\n          </div>\n        </div>\n      );\n    }\n  });\n\n  const findVobjectElem = (vobjectId) => {\n    return $('[data-vobject-id=${vobjectId}]');\n  };\n\n  return { SimpleVObjectComponent,\n    // XXX: possibly not the right place for this, but only if we ever end up\n    // with different classes of vobject\n    findVobjectElem\n  };\n});\n"]}