{"version":3,"sources":["../../../../../../../www/js/app/gui/jsx/vobjects/simple.js"],"names":[],"mappings":"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","file":"simple.js","sourcesContent":["define(['react', 'react-dom', 'jquery', 'lodash',\n        'lib/react-textarea-autosize/TextareaAutosize'],\n(React, ReactDOM, $, _, Textarea) => {\n  /**\n   * Implementation of a default vobject with no fancy custom gui\n   */\n  const SimpleVObjectComponent = React.createClass({\n    propTypes: {\n      patchModel: React.PropTypes.object.isRequired,\n      patchComponent: React.PropTypes.object.isRequired,\n      vobject: React.PropTypes.object.isRequired\n    },\n\n    componentDidMount() {\n      this.makeDraggable();\n    },\n\n    onOutputMouseDown(e) {\n      const patchElem = $(ReactDOM.findDOMNode(this)).parents('.patch');\n      if (!patchElem.length) {\n        throw new Error(\"couldn't find parent patch\");\n      }\n\n      this.props.patchComponent.startDrawingDedge(this,\n        parseInt($(e.currentTarget).attr('data-output-index'), 10),\n        e.clientX,\n        e.clientY);\n\n      e.stopPropagation();\n    },\n\n    onDoubleClick(e) {\n      this.showPropertiesPage();\n    },\n\n    makeDraggable() {\n      $(ReactDOM.findDOMNode(this)).draggable({\n        drag: (event, ui) => {\n          // move the patch\n          this.props.patchModel.setVobjectPosition(this.props.vobject.id,\n            ui.position.left,\n            ui.position.top);\n\n          // tell the parent patch to redraw it\n          this.props.patchComponent.updateVobject(this);\n        },\n        stop: (event, ui) => {\n          this.props.patchModel.setVobjectPosition(this.props.vobject.id,\n              ui.position.left,\n              ui.position.top);\n        }\n      }).addClass('draggable');\n    },\n\n    render() {\n      const pos = this.props.patchModel.getVobjectPosition(this.props.vobject.id);\n      const style = {\n        position: 'absolute',\n        top: pos.y,\n        left: pos.x\n      };\n\n      return (\n        <div className=\"vobject-simple\" data-vobject-id={this.props.vobject.id}\n          style={style}\n        >\n          <div className=\"inputs\">\n            {\n              _.range(this.props.vobject.numInputs()).map((i) =>\n                <span className=\"input\" data-input-index={i} key={i}></span>\n              )\n            }\n          </div>\n          <span className=\"vobject-class\"\n            dangerouslySetInnerHTML={ { __html: this.props.vobject.constructor.vobjectSymbol } }\n          />\n          <Textarea className=\"args\" rows={1} onBlur={this.onChangeArgs}\n            defaultValue={this.props.vobject.args.join(\" \")}\n          />\n          <div className=\"outputs\">\n            {\n              _.range(this.props.vobject.numOutputs()).map((i) =>\n                (<span className=\"output\" data-output-index={i}\n                  onMouseDown={this.onOutputMouseDown} key={i}\n                />)\n              , this)\n            }\n          </div>\n        </div>\n      );\n    },\n\n    onChangeArgs(e) {\n      const args = this.props.vobject.constructor.processArgString(e.target.value);\n      if (_.isEqual(this.props.vobject.args, args)) {\n        return;\n      }\n      this.props.patchModel.updateVobjectArgs(this.props.vobject, args);\n      // re-render so that all vobject refs gets updated\n      this.props.patchComponent.setState({});\n    },\n  });\n\n  const findVobjectElem = (vobjectId) => {\n    return $(`[data-vobject-id=${vobjectId}]`);\n  };\n\n  return { SimpleVObjectComponent,\n    // XXX: possibly not the right place for this, but only if we ever end up\n    // with different classes of vobject\n    findVobjectElem\n  };\n});\n"]}