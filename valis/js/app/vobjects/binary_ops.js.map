{"version":3,"sources":["../../../../../www/js/app/vobjects/binary_ops.js"],"names":[],"mappings":";;;;;;;;;;AAAA,OAAO,CAAC,sBAAD,EAAyB,UAAzB,CAAP,EACA,UAAC,OAAD,EAAU,IAAV,EAAmB;MACX;;;AACJ,aADI,QACJ,CAAY,OAAZ,EAAqB,OAArB,EAA8B;4BAD1B,UAC0B;;yEAD1B,qBAEI,SAAS,UADa;;AAE5B,YAAK,OAAL,GAAe,WAAW,CAAX,CAFa;;KAA9B;;iBADI;;kCAMQ;AAAE,eAAO,CAAP,CAAF;;;;mCACC;AAAE,eAAO,CAAP,CAAF;;;;+BAEJ,SAAS,QAAQ,SAAS;AACjC,YAAI,OAAO,CAAP,MAAc,SAAd,EAAyB;AAC3B,iBAAO,CAAC,CAAD,CAAP,CAD2B;SAA7B;;AAIA,YAAM,YAAY,KAAK,YAAL,CAAkB,OAAO,CAAP,CAAlB,CAAZ,CAL2B;AAMjC,YAAM,aAAa,KAAK,YAAL,CAAkB,OAAO,CAAP,CAAlB,CAAb,CAN2B;;AAQjC,YAAI,aAAa,UAAb,EAAyB;AAC3B,cAAM,UAAS,QAAQ,SAAR,EAAT,CADqB;AAE3B,eAAK,IAAI,IAAI,CAAJ,EAAO,IAAI,OAAO,CAAP,EAAU,MAAV,EAAkB,GAAtC,EAA2C;AACzC,oBAAO,CAAP,IAAY,KAAK,EAAL,CAAQ,OAAO,CAAP,EAAU,CAAV,CAAR,EAAsB,OAAO,CAAP,EAAU,CAAV,CAAtB,CAAZ,CADyC;WAA3C;AAGA,iBAAO,CAAC,OAAD,CAAP,CAL2B;SAA7B;;AAQA,YAAI,cAAJ,CAhBiC;AAiBjC,YAAI,kBAAJ,CAjBiC;;AAmBjC,YAAI,UAAJ,EAAgB;AACd,eAAK,OAAO,CAAP,CAAL,CADc;AAEd,mBAAS,OAAO,CAAP,CAAT,CAFc;SAAhB,MAGO,IAAI,SAAJ,EAAe;AACpB,eAAK,OAAO,CAAP,CAAL,CADoB;AAEpB,mBAAS,OAAO,CAAP,CAAT,CAFoB;AAGpB,cAAI,WAAW,SAAX,EAAsB;AACxB,qBAAS,KAAK,OAAL,CADe;AAExB,gBAAI,WAAW,SAAX,EAAsB;AACxB,oBAAM,IAAI,KAAJ,CAAU,kBAAV,CAAN,CADwB;aAA1B;WAFF;SAHK,MASA;AACL,iBAAO,CAAC,OAAO,CAAP,IAAY,OAAO,CAAP,CAAZ,CAAR,CADK;SATA;;AAaP,YAAM,SAAS,QAAQ,SAAR,EAAT,CAnC2B;AAoCjC,aAAK,IAAI,IAAI,CAAJ,EAAO,IAAI,GAAG,MAAH,EAAW,GAA/B,EAAoC;AAClC,iBAAO,CAAP,IAAY,KAAK,EAAL,CAAQ,GAAG,CAAH,CAAR,EAAe,WAAW,MAAX,CAAf,CAAZ,CADkC;SAApC;;AAIA,eAAO,CAAC,MAAD,CAAP,CAxCiC;;;;WAT/B;IAAiB,QAAQ,OAAR,EADN;;MAsDX;;;;;;;;;;;yBACD,GAAG,GAAG;AAAE,eAAO,IAAI,CAAJ,CAAT;;;;WADL;IAAY,UAtDD;;AA0DjB,MAAI,YAAJ,GAAmB,GAAnB,CA1DiB;AA2DjB,MAAI,aAAJ,GAAoB,GAApB,CA3DiB;;MA6DX;;;;;;;;;;;yBACD,GAAG,GAAG;AAAE,eAAO,IAAI,CAAJ,CAAT;;;;WADL;IAAY,UA7DD;;AAiEjB,MAAI,YAAJ,GAAmB,GAAnB,CAjEiB;AAkEjB,MAAI,aAAJ,GAAoB,GAApB,CAlEiB;;AAoEjB,SAAO,EAAE,QAAF,EAAO,QAAP,EAAP,CApEiB;CAAnB,CADA","file":"binary_ops.js","sourcesContent":["define(['app/vobjects/vobject', 'app/util'],\n(vobject, util) => {\n  class BinaryOp extends vobject.VObject {\n    constructor(options, operand) {\n      super(options, operand);\n      this.operand = operand || 0;\n    }\n\n    numInputs() { return 2; }\n    numOutputs() { return 1; }\n\n    generate(context, inputs, outputs) {\n      if (inputs[0] === undefined) {\n        return [0];\n      }\n\n      const firstIsAa = util.isAudioArray(inputs[0]);\n      const secondIsAa = util.isAudioArray(inputs[1]);\n\n      if (firstIsAa && secondIsAa) {\n        const result = context.getBuffer();\n        for (let i = 0; i < inputs[0].length; i++) {\n          result[i] = this.fn(inputs[0][i], inputs[1][i]);\n        }\n        return [result];\n      }\n\n      let aa;\n      let scalar;\n\n      if (secondIsAa) {\n        aa = inputs[1];\n        scalar = inputs[0];\n      } else if (firstIsAa) {\n        aa = inputs[0];\n        scalar = inputs[1];\n        if (scalar === undefined) {\n          scalar = this.operand;\n          if (scalar === undefined) {\n            throw new Error('no operand found');\n          }\n        }\n      } else {\n        return [inputs[0] * inputs[1]];\n      }\n\n      const result = context.getBuffer();\n      for (let i = 0; i < aa.length; i++) {\n        result[i] = this.fn(aa[i], parseFloat(scalar));\n      }\n\n      return [result];\n    }\n  }\n\n  class Mul extends BinaryOp {\n    fn(a, b) { return a * b; }\n  }\n\n  Mul.vobjectClass = '*';\n  Mul.vobjectSymbol = '*';\n\n  class Add extends BinaryOp {\n    fn(a, b) { return a + b; }\n  }\n\n  Add.vobjectClass = '+';\n  Add.vobjectSymbol = '+';\n\n  return { Mul, Add };\n});\n"]}